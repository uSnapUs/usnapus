<% @title = "Create an Event"
@body_class = "blue"%>
<section class="container-fluid">
  
  <%= form_for @event, html: {class: "event"} do |f| %>
    <div class="row-fluid details"> 
      
      <div class="span4"></div>
      
      <div class="span6 bottom_pad">
        <div id="float_over_google_map">
          <%= f.text_field :location, "placeholder" => "Add the location of your event", :class=>"large grey_border", :tabindex => 1 %>
          <%= f.hidden_field :latitude %>
          <%= f.hidden_field :longitude %>
        </div>
        <div id="google_map" class="">
        </div>
      </div>
      
      <div class="span6 bottom_pad">
        <%= f.text_field :name, "placeholder" => "Give your event a name", :class=>"large grey_border", :tabindex => 2 %>
      </div>
      
      <div class="span6 bottom_pad">
        <div class="datepicker" data-input="#event_starts"></div>
        <%= f.hidden_field :starts %>
        <%= f.hidden_field :ends %>
      </div>
      
      <div class="span6 btn-group privacy">
        <a class="btn active" data-val="public" href="#">Public</a>
        <a class="btn" data-val="private" href="#">Private</a>
      </div>
    
      <%= f.hidden_field :is_public %>
    
      <div class="span6 explanation center bottom_pad">
        <div class="public">
          <p>
            <i class="icon-eye-open"></i>
            Public: Any one with the link below can view photos
          </p>
          <p>
            <div class="input-prepend event_code">
              <span class="add-on">http://usnap.us/</span>
              <%= f.text_field :code, :class => "input-small", value: Event.generate_unique_code %>
            </div>
          </p>
        </div>
        <div class="private hidden">
          <p>
            <i class="icon-lock"></i>
            Private: Guests need to log in to see photos
          </p>
        </div>
      </div>
      
      <div class="span6">
        <a class="span7 btn btn-success btn-large continue">Continue</a>
      </div>
    </div>
  
    <div class="row-fluid payment">
      <div class="span12">
        <div class="hero-unit">
          <div class="hero_pad">
            <h1 class="event_name bottom_pad"></h1>
        
            <p class="options">
              <%= f.submit "Get it Free", :class=>"btn btn-success btn-large buy" %>
            </p>
            <p>
              <span class="brand">uSnap.us</span> is excited to knock $99 off the price for anyone who signs up before April 15th.
            </p>
          </div>
        </div>
      </div>
      <div class="">
        <div class="pricing">
          <h3 class="span12 show_details">
            See pricing details <i class="icon-chevron-down"></i>
          </h3>
          <div class="span12">
          <table class=" details table table-striped">
            <thead>
              <tr>
                <td></td>
                <td>Free</td>
                <td><del>$99</del> Free until April 15</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Live Photocast</td>
                <td>First 10 photos only</td>
                <td><i class="icon-ok"></i></td>
              </tr>
              <tr>
                <td>Slideshow</td>
                <td>First 10 photos only</td>
                <td><i class="icon-ok"></i></td>
              </tr>
              <tr>
                <td>Free iPhone app</td>
                <td><i class="icon-ok"></i></td>
                <td><i class="icon-ok"></i></td>
              </tr>
              <tr>
                <td>Unlimited Guests</td>
                <td><i class="icon-ok"></i></td>
                <td><i class="icon-ok"></i></td>
              </tr>
              <tr>
                <td>Unlimited Photos</td>
                <td><i class="icon-ok"></i></td>
                <td><i class="icon-ok"></i></td>
              </tr>
              <tr>
                <td>Photo Sharing</td>
                <td>Only you can view photos</td>
                <td>Public or Private sharing</td>
              </tr>
              <tr>
                <td>Custom Domain</td>
                <td></td>
                <td><i class="icon-ok"></i></td>
              </tr>
              <tr>
                <td>Web page Hosting</td>
                <td>30 Days</td>
                <td>1 year</td>
              </tr>
              <tr>
                <td>Bulk Photo Download</td>
                <td></td>
                <td><i class="icon-ok"></i></td>
              </tr>
            </tbody>
          </table>
          </div>
        </div>
      </div>
    </div>
  <% end %>
    
</section>

<% content_for(:post_scripts) do %>
  <script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
  <%= stylesheet_link_tag "jquery-ui-1.8.18" %>
<% end %>
<% content_for(:jquery) do %>
  var six_am_in_ms = 6*60*60*1000;
  
  $(".datepicker").datepicker({
		changeMonth: true,
		changeYear: true,
		showOtherMonths: true,
		selectOtherMonths: true,
		minDate: 0,
		altField: "#event_starts",
		dateFormat: "@",
		onSelect: function(dateText, inst){
		  $("#event_starts").val(parseInt(dateText)+six_am_in_ms);
		  $("#event_ends").val(end_of_date(parseInt(dateText)).getTime());
		  showDateIncrementer();
		},
		onChangeMonthYear: function(){
		  $("#date_incrementer").fadeOut();
		}
	});
	//Default the start time to 6am
	$("#event_starts").val(parseInt($("#event_starts").val())+six_am_in_ms);
	//Default ends at to starts at's date, 23:59:59
  $("#event_ends").val(end_of_date(parseInt($("#event_starts").val())).getTime());
<% end %>

<div id="date_incrementer" class="date_incrementer">
  <div class="arrow_wrap">
    <span>Duration</span><a class="minus"><i class="icon-minus"></i></a><a class="plus"><i class="icon-plus"></i></a>
  </div>
</div>